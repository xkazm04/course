# OpenForge

AI-powered learning platform where students learn by building real software. Features personalized learning paths generated by Google Gemini with Google Search grounding, dynamic course content generation, and comprehensive Datadog observability.

## Quick Start

### Prerequisites

- Node.js 20+
- Python 3.11+
- Supabase account
- Google Cloud account (for Gemini API)
- Datadog account (for observability)

### 1. Clone and Install

```bash
git clone https://github.com/your-org/openforge.git
cd openforge

# Install frontend dependencies
npm install
```

### 2. Environment Setup

Create `.env.local` in the project root:

```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# AI (for frontend course generation)
ANTHROPIC_API_KEY=your-anthropic-key
```

### 3. Database Setup

```bash
# Install Supabase CLI
npm install -g supabase

# Link to your project
supabase link --project-ref your-project-ref

# Run migrations
supabase db push
```

### 4. Run Development Server

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000)

---

## Cloud Services Deployment

The AI backend services run on Google Cloud Run.

### Oracle Service (Learning Path Generation)

```bash
cd cloud/oracle

# Set environment variables
export GOOGLE_API_KEY=your-gemini-api-key
export SUPABASE_URL=your-supabase-url
export SUPABASE_SERVICE_KEY=your-service-role-key
export DD_API_KEY=your-datadog-api-key
export DD_SERVICE=oracle
export DD_ENV=production

# Deploy to Cloud Run
gcloud run deploy oracle \
  --source . \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars "GOOGLE_API_KEY=$GOOGLE_API_KEY,SUPABASE_URL=$SUPABASE_URL,SUPABASE_SERVICE_KEY=$SUPABASE_SERVICE_KEY,DD_API_KEY=$DD_API_KEY,DD_SERVICE=oracle,DD_ENV=production"
```

### Content Generator Service

```bash
cd cloud/content-generator

# Deploy to Cloud Run
gcloud run deploy content-generator \
  --source . \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars "GOOGLE_API_KEY=$GOOGLE_API_KEY,SUPABASE_URL=$SUPABASE_URL,SUPABASE_SERVICE_KEY=$SUPABASE_SERVICE_KEY,DD_API_KEY=$DD_API_KEY,DD_SERVICE=content-generator,DD_ENV=production"
```
## Environment Variables Reference

### Frontend (.env.local)

| Variable | Required | Description |
|----------|----------|-------------|
| `NEXT_PUBLIC_SUPABASE_URL` | Yes | Supabase project URL |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Yes | Supabase anon/public key |
| `SUPABASE_SERVICE_ROLE_KEY` | Yes | Supabase service role key (server-side) |
| `ANTHROPIC_API_KEY` | Yes | Anthropic API key for Claude |

### Cloud Services

| Variable | Required | Description |
|----------|----------|-------------|
| `GOOGLE_API_KEY` | Yes | Google AI API key for Gemini |
| `SUPABASE_URL` | Yes | Supabase project URL |
| `SUPABASE_SERVICE_KEY` | Yes | Supabase service role key |
| `DD_API_KEY` | Yes | Datadog API key |
| `DD_SERVICE` | Yes | Service name (`oracle`, `content-generator`) |
| `DD_ENV` | Yes | Environment (`production`, `development`) |
| `DD_TRACE_ENABLED` | No | Enable APM tracing (default: true) |
| `DD_LOGS_INJECTION` | No | Inject trace IDs into logs (default: true) |

---

## Key Features

### Learning Oracle
Personalized path generation via conversational AI:
- Multi-step onboarding wizard
- Google Search grounding for market trends
- Generates hierarchical learning paths (Domain > Topic > Subtopic)

### Knowledge Map
Interactive hex-grid visualization:
- Zoom, pan, and drill-down navigation
- Real-time content generation status
- Tree breadcrumb navigation

### Gamification
Duolingo-inspired engagement:
- XP and leveling system
- Daily streaks with freeze tokens
- Achievements with rarity tiers
- Milestone celebrations

### Adaptive Content
Behavior-based personalization:
- Quiz performance tracking
- Video playback pattern analysis
- Content density adjustment

---



---
## Architecture
```
┌─────────────────────────────────────────────────────────────────────────┐
│                           OpenForge Platform                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │                     Next.js 15 Frontend                            │ │
│  │                                                                     │ │
│  │  src/app/                                                          │ │
│  │  ├── forge/           # Main learning platform                     │ │
│  │  │   ├── map/         # Hex grid knowledge map                     │ │
│  │  │   ├── community/   # Community paths                            │ │
│  │  │   └── profile/     # User profile & progress                    │ │
│  │  ├── features/        # Self-contained feature modules             │ │
│  │  │   ├── knowledge-map/                                            │ │
│  │  │   ├── adaptive-content/                                         │ │
│  │  │   ├── progress/                                                 │ │
│  │  │   ├── streaks/                                                  │ │
│  │  │   └── code-playground/                                          │ │
│  │  └── api/             # Next.js API routes                         │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                   │                                      │
│                                   ▼                                      │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │                    Cloud Services (Python Flask)                   │ │
│  │                                                                     │ │
│  │  cloud/                                                            │ │
│  │  ├── oracle/          # Learning path generation (Gemini)          │ │
│  │  ├── content-generator/ # Course content generation (Gemini)       │ │
│  │  └── shared/          # Shared metrics & utilities                 │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                   │                                      │
│           ┌───────────────────────┼───────────────────────┐             │
│           ▼                       ▼                       ▼             │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐      │
│  │   Supabase       │  │   Google Gemini  │  │   Datadog        │      │
│  │   (PostgreSQL)   │  │   (LLM + Search) │  │   (Observability)│      │
│  └──────────────────┘  └──────────────────┘  └──────────────────┘      │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### Frontend Architecture
- **Next.js 16** with App Router for server-side rendering and API routes
- **React 19** with client components and hooks for interactive features
- **TypeScript** throughout for type safety
- **Framer Motion** for fluid animations and transitions
- **Tailwind CSS 4** for styling with custom design tokens

### Feature Module Pattern
Self-contained feature modules in `src/app/features/` each with:
- Public API via `index.ts`
- Business logic in `lib/` (types, hooks, storage)
- UI components in `components/`

Key features include:
- `knowledge-map` - Interactive curriculum visualization
- `adaptive-content` - Behavior-based content adaptation
- `progress` - Learning progress tracking with video resume
- `streaks` - Duolingo-style gamification
- `code-playground` - Interactive code execution

### AI Backend Services (Python Flask)
Three microservices deployed on Google Cloud Run:

**Oracle Service** (`cloud/oracle/`)
- Conversational path generation with Gemini 2.0 Flash
- Google Search grounding for market trend awareness
- Session management via Supabase
- Comprehensive Datadog instrumentation

**Content Generator** (`cloud/content-generator/`)
- On-demand course and chapter generation
- Job queue system with progress tracking
- Path acceptance workflow for batch node creation

**Shared Metrics Module** (`cloud/shared/`)
- Standardized Datadog metrics emission
- Token counting and cost estimation
- LLM request/response tracking

### Database
- **Supabase** (PostgreSQL) with 9 migration files covering:
  - Core curriculum schema (categories, courses, chapters, sections)
  - User progress and gamification (XP, achievements, streaks)
  - AI-generated content tracking (map_nodes, content_generation_jobs)
  - Learning path management and enrollments

## Datadog LLM Observability (Hackathon)

This project includes comprehensive Datadog integration for LLM observability, meeting all hackathon requirements.

### Hard Requirements Checklist

| Requirement | Status | Implementation |
|-------------|--------|----------------|
| **Use Vertex AI or Gemini** | ✅ | Gemini 2.0 Flash with Google Search grounding |
| **Report telemetry to Datadog** | ✅ | APM traces, custom metrics, structured logs |
| **Define at least 3 detection rules** | ✅ | 7 monitors defined (see below) |
| **In-Datadog view showing app health** | ✅ | Dashboard with 24 widgets |
| **Show latency, errors, tokens, cost** | ✅ | KPI widgets + timeseries charts |
| **Show SLOs and actionable items** | ✅ | SLO definitions + runbooks in alerts |
| **Create actionable records (Incidents)** | ✅ | Monitor messages include runbooks |
| **Contextual information for next steps** | ✅ | Each alert has detailed remediation steps |

### Detection Rules (Monitors)

| Monitor | Type | Threshold |
|---------|------|-----------|
| LLM Response Latency Critical | Metric Alert | > 10,000ms |
| LLM API Error Rate Elevated | Query Alert | > 10 errors/5min |
| Content Generation Failures | Query Alert | > 5 failures/15min |
| Project Scanner Failures | Query Alert | > 3 failures/15min |
| Scan Latency Critical | Metric Alert | > 180,000ms |
| GitHub API Rate Limit | Metric Alert | < 100 remaining |
| Assignment Completion Low | Query Alert | < 1/day |

### Custom Metrics

**LLM Metrics:**
- `llm.gemini.request.count` - Total API calls
- `llm.gemini.request.latency` - Response time (ms)
- `llm.gemini.tokens.input` / `output` / `total` - Token usage
- `llm.gemini.cost.usd` - Estimated cost
- `llm.gemini.errors` - Error counts by type
- `llm.gemini.grounding.used` - Google Search grounding usage

**Business Metrics:**
- `oracle.session.created` - Learning path sessions
- `oracle.path.generated` - Paths generated by domain
- `content.job.completed` - Content generation jobs
- `content.course.created` - Courses created
- `project.repo.scanned` - Repositories analyzed
- `project.feature.extracted` - Features decomposed
- `project.scan.job.*` - Scan job lifecycle
- `project.assignment.*` - Homework assignment lifecycle
- `project.github.rate_limit.*` - GitHub API quota


---

## License

MIT License - see LICENSE file for details.